!
! Automatically generated by ./mod_rw_for_rttov_types.pl
! Do not edit
!
! Copyright:
!    This software was developed within the context of
!    the EUMETSAT Satellite Application Facility on
!    Numerical Weather Prediction (NWP SAF), under the
!    Cooperation Agreement dated 7 December 2016, between
!    EUMETSAT and the Met Office, UK, by one or more partners
!    within the NWP SAF. The partners in the NWP SAF are
!    the Met Office, ECMWF, DWD and MeteoFrance.
!
!    Copyright 2016, EUMETSAT, All Rights Reserved.
!
module rttov_hdf_rttov_coef_io
#include "throw.h"
use parkind1
!use rttov_print_mod
use rttov_hdf_mod
!use rttov_hdf_rttov_coef_def
!use rttov_hdf_rttov_coef_mem
use rttov_types

use hdf5
implicit none
#include "rttov_errorreport.interface"
private
public :: rttov_hdf_rttov_coef_init
public :: rttov_hdf_rttov_coef_rh
public :: rttov_hdf_rttov_coef_wh


contains


subroutine rttov_hdf_rttov_coef_init(x)
type(rttov_coef),intent(inout)::x

  x%ID_PLATFORM=0_jpim
  x%ID_SAT=0_jpim
  x%ID_INST=0_jpim
  x%ID_SENSOR=0_jpim
  x%ID_COMP_LVL=0_jpim
  x%ID_COMP_PC=0_jpim
  x%ID_CREATION_DATE=0_jpim
  x%ID_CREATION=''
  x%ID_COMMON_NAME=''
  x%LINE_BY_LINE=''
  x%FMV_MODEL_DEF=''
  x%FMV_MODEL_VER=0_jpim
  x%FMV_ORI_NCHN=0_jpim
  x%FMV_CHN=0_jpim
  x%FMV_GAS=0_jpim
  nullify(x%FMV_GAS_ID)
  nullify(x%FMV_GAS_POS)
  nullify(x%FMV_VAR)
  nullify(x%FMV_COE)
  nullify(x%FMV_NCORR)
  nullify(x%FMV_LVL)
  x%INCZEEMAN=.false.
  x%NLEVELS=0_jpim
  x%NLAYERS=0_jpim
  x%NMIXED=0_jpim
  x%NWATER=0_jpim
  x%NOZONE=0_jpim
  x%NWVCONT=0_jpim
  x%NCO2=0_jpim
  x%NN2O=0_jpim
  x%NCO=0_jpim
  x%NCH4=0_jpim
  x%NSO2=0_jpim
  x%NCMIXED=0_jpim
  x%NCWATER=0_jpim
  x%NCOZONE=0_jpim
  x%NCWVCONT=0_jpim
  x%NCCO2=0_jpim
  x%NCN2O=0_jpim
  x%NCCO=0_jpim
  x%NCCH4=0_jpim
  x%NCSO2=0_jpim
  x%NCCMIXED=0_jpim
  x%NCCWATER=0_jpim
  x%NCCOZONE=0_jpim
  x%NCCWVCONT=0_jpim
  x%NCCCO2=0_jpim
  x%NCCN2O=0_jpim
  x%NCCCO=0_jpim
  x%NCCCH4=0_jpim
  x%NCCSO2=0_jpim
  x%FC_PLANCK_C1=0._jprb
  x%FC_PLANCK_C2=0._jprb
  x%FC_SAT_HEIGHT=0._jprb
  x%README_SRF=''
  nullify(x%FF_ORI_CHN)
  nullify(x%FF_VAL_CHN)
  nullify(x%FF_CWN)
  nullify(x%FF_BCO)
  nullify(x%FF_BCS)
  nullify(x%FF_GAM)
  nullify(x%TT_VAL_CHN)
  nullify(x%TT_A0)
  nullify(x%TT_A1)
  nullify(x%PW_VAL_CHN)
  nullify(x%SS_VAL_CHN)
  nullify(x%SS_SOLAR_SPECTRUM)
  nullify(x%SS_RAYLEIGH_EXT)
  nullify(x%REFL_VISNIR_OW)
  nullify(x%REFL_VISNIR_FW)
  nullify(x%WOC_WAOPC_OW)
  nullify(x%WOC_WAOPC_FW)
  x%WS_NOMEGA=1_JPIM
  nullify(x%WS_NPOINT)
  nullify(x%WS_K_OMEGA)
  nullify(x%FASTEM_POLAR)
  nullify(x%POL_PHI)
  x%SSIREM_VER=0_jpim
  nullify(x%SSIREM_A0)
  nullify(x%SSIREM_A1)
  nullify(x%SSIREM_A2)
  nullify(x%SSIREM_XZN1)
  nullify(x%SSIREM_XZN2)
  x%IREMIS_VERSION=0_jpim
  x%IREMIS_NCOEF=0_jpim
  x%IREMIS_ANGLE0=0._jprb
  x%IREMIS_TSKIN0=0._jprb
  nullify(x%IREMIS_COEF)
  nullify(x%REF_PRFL_P)
  nullify(x%REF_PRFL_T)
  nullify(x%REF_PRFL_MR)
  nullify(x%BKG_PRFL_MR)
  nullify(x%LIM_PRFL_P)
  nullify(x%ENV_PRFL_TMAX)
  nullify(x%ENV_PRFL_TMIN)
  nullify(x%ENV_PRFL_GMAX)
  nullify(x%ENV_PRFL_GMIN)
  nullify(x%LIM_PRFL_TMAX)
  nullify(x%LIM_PRFL_TMIN)
  nullify(x%LIM_PRFL_GMAX)
  nullify(x%LIM_PRFL_GMIN)
  x%PMC_LENGTHCELL=0._jprb
  nullify(x%PMC_PNOMINAL)
  x%PMC_TEMPCELL=0._jprb
  x%PMC_BETAPLUS1=0._jprb
  x%PMC_NLAY=0_jpim
  x%PMC_NVAR=0_jpim
  nullify(x%PMC_COEF)
  nullify(x%PMC_PPMC)
  x%RATOE=0._jprb
  x%SOLARCOEF=.false.
  x%NLTECOEF=.false.
  x%PMC_SHIFT=.false.
  nullify(x%PLANCK1)
  nullify(x%PLANCK2)
  nullify(x%FREQUENCY_GHZ)
  nullify(x%DP)
  nullify(x%DPP)
  nullify(x%TSTAR)
  nullify(x%TO3STAR)
  nullify(x%WSTAR)
  nullify(x%OSTAR)
  nullify(x%CO2STAR)
  nullify(x%N2OSTAR)
  nullify(x%COSTAR)
  nullify(x%CH4STAR)
  nullify(x%SO2STAR)
  nullify(x%BOUNDS)
end subroutine

subroutine rttov_hdf_rttov_coef_rh(x,lun,err)
type(rttov_coef),intent(out)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
character(len=lensh)::sname
logical :: lext
TRY

call rttov_hdf_rttov_coef_init(x)

sname='ID_PLATFORM'
call read_array_hdf(lun,sname,err,i0=x%ID_PLATFORM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_SAT'
call read_array_hdf(lun,sname,err,i0=x%ID_SAT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_INST'
call read_array_hdf(lun,sname,err,i0=x%ID_INST)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_SENSOR'
call read_array_hdf(lun,sname,err,i0=x%ID_SENSOR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_COMP_LVL'
call read_array_hdf(lun,sname,err,i0=x%ID_COMP_LVL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_COMP_PC'
call read_array_hdf(lun,sname,err,i0=x%ID_COMP_PC)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_CREATION_DATE'
call read_array_hdf(lun,sname,err,i1=x%ID_CREATION_DATE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_CREATION'
call read_array_hdf(lun,sname,err,c0=x%ID_CREATION)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ID_COMMON_NAME'
call read_array_hdf(lun,sname,err,c0=x%ID_COMMON_NAME)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LINE_BY_LINE'
call read_array_hdf(lun,sname,err,c1=x%LINE_BY_LINE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_MODEL_DEF'
call read_array_hdf(lun,sname,err,c0=x%FMV_MODEL_DEF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_MODEL_VER'
call read_array_hdf(lun,sname,err,i0=x%FMV_MODEL_VER)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))


sname='FMV_CHN'
call read_array_hdf(lun,sname,err,i0=x%FMV_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_GAS'
call read_array_hdf(lun,sname,err,i0=x%FMV_GAS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_GAS_ID'
call read_array_hdf(lun,sname,err,pi1=x%FMV_GAS_ID)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_GAS_POS'
call read_array_hdf(lun,sname,err,pi1=x%FMV_GAS_POS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_VAR'
call read_array_hdf(lun,sname,err,pi1=x%FMV_VAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_COE'
call read_array_hdf(lun,sname,err,pi1=x%FMV_COE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FMV_NCORR'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%FMV_NCORR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='FMV_LVL'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%FMV_LVL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='INCZEEMAN'
call read_array_hdf(lun,sname,err,l0=x%INCZEEMAN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='NLEVELS'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%NLEVELS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif





























sname='FC_PLANCK_C1'
call read_array_hdf(lun,sname,err,r0=x%FC_PLANCK_C1)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FC_PLANCK_C2'
call read_array_hdf(lun,sname,err,r0=x%FC_PLANCK_C2)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FC_SAT_HEIGHT'
call read_array_hdf(lun,sname,err,r0=x%FC_SAT_HEIGHT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='README_SRF'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,c1=x%README_SRF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='FF_ORI_CHN'
call read_array_hdf(lun,sname,err,pi1=x%FF_ORI_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FF_VAL_CHN'
call read_array_hdf(lun,sname,err,pi1=x%FF_VAL_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FF_CWN'
call read_array_hdf(lun,sname,err,pr1=x%FF_CWN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FF_BCO'
call read_array_hdf(lun,sname,err,pr1=x%FF_BCO)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FF_BCS'
call read_array_hdf(lun,sname,err,pr1=x%FF_BCS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='FF_GAM'
call read_array_hdf(lun,sname,err,pr1=x%FF_GAM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='TT_VAL_CHN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%TT_VAL_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='TT_A0'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%TT_A0)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='TT_A1'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%TT_A1)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PW_VAL_CHN'
call read_array_hdf(lun,sname,err,pi1=x%PW_VAL_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='SS_VAL_CHN'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%SS_VAL_CHN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SS_SOLAR_SPECTRUM'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SS_SOLAR_SPECTRUM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SS_RAYLEIGH_EXT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SS_RAYLEIGH_EXT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif



sname='WOC_WAOPC_OW'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf_cmplx(lun,sname,err,pk1=x%WOC_WAOPC_OW)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WOC_WAOPC_FW'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf_cmplx(lun,sname,err,pk1=x%WOC_WAOPC_FW)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WS_NOMEGA'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%WS_NOMEGA)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WS_NPOINT'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%WS_NPOINT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='WS_K_OMEGA'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%WS_K_OMEGA)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='FASTEM_POLAR'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pi1=x%FASTEM_POLAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='POL_PHI'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%POL_PHI)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_VER'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%SSIREM_VER)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_A0'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SSIREM_A0)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_A1'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SSIREM_A1)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_A2'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SSIREM_A2)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_XZN1'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SSIREM_XZN1)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SSIREM_XZN2'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SSIREM_XZN2)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='IREMIS_VERSION'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%IREMIS_VERSION)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='IREMIS_NCOEF'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%IREMIS_NCOEF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='IREMIS_ANGLE0'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%IREMIS_ANGLE0)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='IREMIS_TSKIN0'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%IREMIS_TSKIN0)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='IREMIS_COEF'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%IREMIS_COEF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='REF_PRFL_P'
call read_array_hdf(lun,sname,err,pr1=x%REF_PRFL_P)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='REF_PRFL_T'
call read_array_hdf(lun,sname,err,pr2=x%REF_PRFL_T)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='REF_PRFL_MR'
call read_array_hdf(lun,sname,err,pr2=x%REF_PRFL_MR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='BKG_PRFL_MR'
call read_array_hdf(lun,sname,err,pr2=x%BKG_PRFL_MR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LIM_PRFL_P'
call read_array_hdf(lun,sname,err,pr1=x%LIM_PRFL_P)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ENV_PRFL_TMAX'
call read_array_hdf(lun,sname,err,pr1=x%ENV_PRFL_TMAX)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ENV_PRFL_TMIN'
call read_array_hdf(lun,sname,err,pr1=x%ENV_PRFL_TMIN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ENV_PRFL_GMAX'
call read_array_hdf(lun,sname,err,pr2=x%ENV_PRFL_GMAX)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ENV_PRFL_GMIN'
call read_array_hdf(lun,sname,err,pr2=x%ENV_PRFL_GMIN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))










sname='PMC_LENGTHCELL'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%PMC_LENGTHCELL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_PNOMINAL'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%PMC_PNOMINAL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_TEMPCELL'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%PMC_TEMPCELL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_BETAPLUS1'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%PMC_BETAPLUS1)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_NLAY'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%PMC_NLAY)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_NVAR'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%PMC_NVAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='PMC_COEF'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr3=x%PMC_COEF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif





















err=0_jpim
CATCH
end subroutine

subroutine rttov_hdf_rttov_coef_wh(x,lun,err,compress,force_double)
type(rttov_coef),intent(in)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
logical,intent(in),optional::compress
logical,intent(in),optional::force_double
character(len=lensh)::sname

TRY
sname='ID_PLATFORM'
call write_array_hdf(lun,sname,&
  & 'Platform ID, see documentation',&
  & err,i0=x%ID_PLATFORM   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_SAT'
call write_array_hdf(lun,sname,&
  & 'Satellite ID, see documentation',&
  & err,i0=x%ID_SAT   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_INST'
call write_array_hdf(lun,sname,&
  & 'Instrument ID, see documentation',&
  & err,i0=x%ID_INST   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_SENSOR'
call write_array_hdf(lun,sname,&
  & 'Sensor ID,  1 = Infrared, 2 = Microwave, 3 = High resolution, 4 = Polarimetric',&
  & err,i0=x%ID_SENSOR   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_COMP_LVL'
call write_array_hdf(lun,sname,&
  & 'RTTOV coefficient file version number',&
  & err,i0=x%ID_COMP_LVL   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_COMP_PC'
call write_array_hdf(lun,sname,&
  & 'Principal component coefficient file version number',&
  & err,i0=x%ID_COMP_PC   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_CREATION_DATE'
call write_array_hdf(lun,sname,&
  & 'Creation Date YYYY MM DD',&
  & err,i1=x%ID_CREATION_DATE   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_CREATION'
call write_array_hdf(lun,sname,&
  & 'Creation comment',&
  & err,c0=x%ID_CREATION   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ID_COMMON_NAME'
call write_array_hdf(lun,sname,&
  & 'Usual name of the satellite',&
  & err,c0=x%ID_COMMON_NAME   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='LINE_BY_LINE'
call write_array_hdf(lun,sname,&
  & 'Line-by-Line information',&
  & err,c1=x%LINE_BY_LINE   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FMV_MODEL_DEF'
call write_array_hdf(lun,sname,&
  & 'Fast model predictors version (RTTOV7 RTTOV8 RTTOV9 RTTOV13)',&
  & err,c0=x%FMV_MODEL_DEF   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FMV_MODEL_VER'
call write_array_hdf(lun,sname,&
  & 'Fast model version compatibility level',&
  & err,i0=x%FMV_MODEL_VER   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))


sname='FMV_CHN'
call write_array_hdf(lun,sname,&
  & 'Number of channels read into coef structure',&
  & err,i0=x%FMV_CHN   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FMV_GAS'
call write_array_hdf(lun,sname,&
  & 'Number of gases in file',&
  & err,i0=x%FMV_GAS   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FMV_GAS_ID'
if(associated(x%FMV_GAS_ID))then
  call write_array_hdf(lun,sname,&
    & 'Gas ID numebr in gas_id list',&
    & err,i1=x%FMV_GAS_ID   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FMV_GAS_POS'
if(associated(x%FMV_GAS_POS))then
  call write_array_hdf(lun,sname,&
    & 'Respective position of each gas of gas_id list',&
    & err,i1=x%FMV_GAS_POS   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FMV_VAR'
if(associated(x%FMV_VAR))then
  call write_array_hdf(lun,sname,&
    & 'number of variables/predictors by gas',&
    & err,i1=x%FMV_VAR   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FMV_COE'
if(associated(x%FMV_COE))then
  call write_array_hdf(lun,sname,&
    & 'number of coefficients by gas',&
    & err,i1=x%FMV_COE   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FMV_NCORR'
if(associated(x%FMV_NCORR))then
  call write_array_hdf(lun,sname,&
    & 'number of correction term coefficients by gas',&
    & err,i1=x%FMV_NCORR   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FMV_LVL'
if(associated(x%FMV_LVL))then
  call write_array_hdf(lun,sname,&
    & 'number of levels(pres/absorber) by gas',&
    & err,i1=x%FMV_LVL   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='INCZEEMAN'
call write_array_hdf(lun,sname,&
  & 'Flag to include Zeeman effect for this sensor',&
  & err,l0=x%INCZEEMAN   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='NLEVELS'
call write_array_hdf(lun,sname,&
  & 'number of coefficient levels',&
  & err,i0=x%NLEVELS   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))





























sname='FC_PLANCK_C1'
call write_array_hdf(lun,sname,&
  & 'First radiation constant',&
  & err,r0=x%FC_PLANCK_C1 , units = 'mW/(m2*sr*cm-4)'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FC_PLANCK_C2'
call write_array_hdf(lun,sname,&
  & 'Second radiation constant',&
  & err,r0=x%FC_PLANCK_C2 , units = 'cm*K'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FC_SAT_HEIGHT'
call write_array_hdf(lun,sname,&
  & 'Satellite nominal altitude',&
  & err,r0=x%FC_SAT_HEIGHT , units = 'km'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='README_SRF'
call write_array_hdf(lun,sname,&
  & 'About filter functions used',&
  & err,c1=x%README_SRF   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FF_ORI_CHN'
if(associated(x%FF_ORI_CHN))then
  call write_array_hdf(lun,sname,&
    & 'original chan number',&
    & err,i1=x%FF_ORI_CHN   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FF_VAL_CHN'
if(associated(x%FF_VAL_CHN))then
  call write_array_hdf(lun,sname,&
    & 'validity of the channel (1=OK)',&
    & err,i1=x%FF_VAL_CHN   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FF_CWN'
if(associated(x%FF_CWN))then
  call write_array_hdf(lun,sname,&
    & 'cental wave number (cm-1)',&
    & err,r1=x%FF_CWN , units = 'cm^-1'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FF_BCO'
if(associated(x%FF_BCO))then
  call write_array_hdf(lun,sname,&
    & 'band correction offset (K)',&
    & err,r1=x%FF_BCO , units = 'K'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FF_BCS'
if(associated(x%FF_BCS))then
  call write_array_hdf(lun,sname,&
    & 'band correction slope (K/K)',&
    & err,r1=x%FF_BCS , units = 'K/K'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FF_GAM'
if(associated(x%FF_GAM))then
  call write_array_hdf(lun,sname,&
    & 'gamma factor transm. correction',&
    & err,r1=x%FF_GAM   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='TT_VAL_CHN'
if(associated(x%TT_VAL_CHN))then
  call write_array_hdf(lun,sname,&
    & 'Transmittance threshold channel validity',&
    & err,i1=x%TT_VAL_CHN   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='TT_A0'
if(associated(x%TT_A0))then
  call write_array_hdf(lun,sname,&
    & 'Transmittance threshold A0',&
    & err,r1=x%TT_A0   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='TT_A1'
if(associated(x%TT_A1))then
  call write_array_hdf(lun,sname,&
    & 'Transmittance threshold A1',&
    & err,r1=x%TT_A1   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='PW_VAL_CHN'
if(associated(x%PW_VAL_CHN))then
  call write_array_hdf(lun,sname,&
    & '0 => non-PW thermal coefs, 1 => PW thermal coefs',&
    & err,i1=x%PW_VAL_CHN   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SS_VAL_CHN'
if(associated(x%SS_VAL_CHN))then
  call write_array_hdf(lun,sname,&
    & '0 => thermal, 1 => thermal+solar , 2=> solar',&
    & err,i1=x%SS_VAL_CHN   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SS_SOLAR_SPECTRUM'
if(associated(x%SS_SOLAR_SPECTRUM))then
  call write_array_hdf(lun,sname,&
    & 'Solar spectrum value',&
    & err,r1=x%SS_SOLAR_SPECTRUM   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SS_RAYLEIGH_EXT'
if(associated(x%SS_RAYLEIGH_EXT))then
  call write_array_hdf(lun,sname,&
    & 'Rayleigh extinction coefficient (km-1)',&
    & err,r1=x%SS_RAYLEIGH_EXT   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif



sname='WOC_WAOPC_OW'
if(associated(x%WOC_WAOPC_OW))then
  call write_array_hdf_cmplx(lun,sname,&
    & 'Water optical constants ocean water',&
    & err,k1=x%WOC_WAOPC_OW   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WOC_WAOPC_FW'
if(associated(x%WOC_WAOPC_FW))then
  call write_array_hdf_cmplx(lun,sname,&
    & 'Water optical constants fresh water',&
    & err,k1=x%WOC_WAOPC_FW   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WS_NOMEGA'
call write_array_hdf(lun,sname,&
  & 'Size of WAVE_SPECTRUM arrays',&
  & err,i0=x%WS_NOMEGA   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='WS_NPOINT'
if(associated(x%WS_NPOINT))then
  call write_array_hdf(lun,sname,&
    & 'Pulsation for waves at the surface of water',&
    & err,r1=x%WS_NPOINT , units = 'rad s-1'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='WS_K_OMEGA'
if(associated(x%WS_K_OMEGA))then
  call write_array_hdf(lun,sname,&
    & 'Wavenumber (for water waves)',&
    & err,r1=x%WS_K_OMEGA , units = 'm-1'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='FASTEM_POLAR'
if(associated(x%FASTEM_POLAR))then
  call write_array_hdf(lun,sname,&
    & 'polarisation of each channel',&
    & err,i1=x%FASTEM_POLAR , units = '0=0.5V+H 1=90-incident ang 2=incident ang 3=V 4=H 5/6=3rd/4th Stokes comp 7=V/H mix'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='POL_PHI'
if(associated(x%POL_PHI))then
  call write_array_hdf(lun,sname,&
    & 'Angles determining V/H mix for pol_id=7 (Tb = Tb_H * cos(phi)^2 + Tb_V * sin(phi)^2)',&
    & err,r1=x%POL_PHI , units = 'degrees'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_VER'
call write_array_hdf(lun,sname,&
  & 'ISEM version number',&
  & err,i0=x%SSIREM_VER   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SSIREM_A0'
if(associated(x%SSIREM_A0))then
  call write_array_hdf(lun,sname,&
    & 'ISEM coef a0',&
    & err,r1=x%SSIREM_A0   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_A1'
if(associated(x%SSIREM_A1))then
  call write_array_hdf(lun,sname,&
    & 'ISEM coef a1',&
    & err,r1=x%SSIREM_A1   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_A2'
if(associated(x%SSIREM_A2))then
  call write_array_hdf(lun,sname,&
    & 'ISEM coef a2',&
    & err,r1=x%SSIREM_A2   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_XZN1'
if(associated(x%SSIREM_XZN1))then
  call write_array_hdf(lun,sname,&
    & 'ISEM coef xzn1',&
    & err,r1=x%SSIREM_XZN1   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SSIREM_XZN2'
if(associated(x%SSIREM_XZN2))then
  call write_array_hdf(lun,sname,&
    & 'ISEM coef xzn2',&
    & err,r1=x%SSIREM_XZN2   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='IREMIS_VERSION'
call write_array_hdf(lun,sname,&
  & 'IR sea emissivity version number',&
  & err,i0=x%IREMIS_VERSION   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='IREMIS_NCOEF'
call write_array_hdf(lun,sname,&
  & 'Number of coefficients per channel',&
  & err,i0=x%IREMIS_NCOEF   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='IREMIS_ANGLE0'
call write_array_hdf(lun,sname,&
  & 'Reference zenith angle value',&
  & err,r0=x%IREMIS_ANGLE0   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='IREMIS_TSKIN0'
call write_array_hdf(lun,sname,&
  & 'Reference Tskin value',&
  & err,r0=x%IREMIS_TSKIN0   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='IREMIS_COEF'
if(associated(x%IREMIS_COEF))then
  call write_array_hdf(lun,sname,&
    & 'IR sea emissivity model coefficients',&
    & err,r2=x%IREMIS_COEF  ,compress=compress )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='REF_PRFL_P'
if(associated(x%REF_PRFL_P))then
  call write_array_hdf(lun,sname,&
    & 'Reference profile pressure',&
    & err,r1=x%REF_PRFL_P , units = 'hPa'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='REF_PRFL_T'
if(associated(x%REF_PRFL_T))then
  call write_array_hdf(lun,sname,&
    & 'Reference profile temperature',&
    & err,r2=x%REF_PRFL_T , units = 'K' ,compress=compress )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='REF_PRFL_MR'
if(associated(x%REF_PRFL_MR))then
  call write_array_hdf(lun,sname,&
    & 'Reference profile gas concentration',&
    & err,r2=x%REF_PRFL_MR , units = 'ppmv' ,compress=compress )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='BKG_PRFL_MR'
if(associated(x%BKG_PRFL_MR))then
  call write_array_hdf(lun,sname,&
    & 'Background profile gas concentration',&
    & err,r2=x%BKG_PRFL_MR , units = 'ppmv' ,compress=compress )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='LIM_PRFL_P'
if(associated(x%LIM_PRFL_P))then
  call write_array_hdf(lun,sname,&
    & 'Envelope pressure',&
    & err,r1=x%LIM_PRFL_P , units = 'hPa'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='ENV_PRFL_TMAX'
if(associated(x%ENV_PRFL_TMAX))then
  call write_array_hdf(lun,sname,&
    & 'Maximum temperature envelope',&
    & err,r1=x%ENV_PRFL_TMAX , units = 'K'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='ENV_PRFL_TMIN'
if(associated(x%ENV_PRFL_TMIN))then
  call write_array_hdf(lun,sname,&
    & 'Minimum temperature envelope',&
    & err,r1=x%ENV_PRFL_TMIN , units = 'K'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='ENV_PRFL_GMAX'
if(associated(x%ENV_PRFL_GMAX))then
  call write_array_hdf(lun,sname,&
    & 'Maximum gas concentration envelope (levels, gases)',&
    & err,r2=x%ENV_PRFL_GMAX , units = 'ppmv' ,compress=compress )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='ENV_PRFL_GMIN'
if(associated(x%ENV_PRFL_GMIN))then
  call write_array_hdf(lun,sname,&
    & 'Minimum gas concentration envelope (levels, gases)',&
    & err,r2=x%ENV_PRFL_GMIN , units = 'ppmv' ,compress=compress )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif










sname='PMC_LENGTHCELL'
call write_array_hdf(lun,sname,&
  & 'Cell length',&
  & err,r0=x%PMC_LENGTHCELL , units = 'cm'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PMC_PNOMINAL'
if(associated(x%PMC_PNOMINAL))then
  call write_array_hdf(lun,sname,&
    & 'Nominal cell pressure',&
    & err,r1=x%PMC_PNOMINAL , units = 'hPa'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='PMC_TEMPCELL'
call write_array_hdf(lun,sname,&
  & 'Cell temperature',&
  & err,r0=x%PMC_TEMPCELL , units = 'K'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PMC_BETAPLUS1'
call write_array_hdf(lun,sname,&
  & 'CO2 band-average: self-HW/air-HW',&
  & err,r0=x%PMC_BETAPLUS1 , units = 'N/A'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PMC_NLAY'
call write_array_hdf(lun,sname,&
  & 'Number of layers used',&
  & err,i0=x%PMC_NLAY   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PMC_NVAR'
call write_array_hdf(lun,sname,&
  & 'Number of variables used',&
  & err,i0=x%PMC_NVAR   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PMC_COEF'
if(associated(x%PMC_COEF))then
  call write_array_hdf(lun,sname,&
    & 'PMC cell corrections',&
    & err,r3=x%PMC_COEF , units = 'N/A' ,compress=compress ,force_double=force_double)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif





















err=0_jpim
CATCH
end subroutine

end module
