!
! Automatically generated by ./mod_rw_for_rttov_types.pl
! Do not edit
!
! Copyright:
!    This software was developed within the context of
!    the EUMETSAT Satellite Application Facility on
!    Numerical Weather Prediction (NWP SAF), under the
!    Cooperation Agreement dated 7 December 2016, between
!    EUMETSAT and the Met Office, UK, by one or more partners
!    within the NWP SAF. The partners in the NWP SAF are
!    the Met Office, ECMWF, DWD and MeteoFrance.
!
!    Copyright 2016, EUMETSAT, All Rights Reserved.
!
module rttov_hdf_radiance2_io
#include "throw.h"
use parkind1
!use rttov_print_mod
use rttov_hdf_mod
!use rttov_hdf_radiance2_def
!use rttov_hdf_radiance2_mem
use rttov_types

use hdf5
implicit none
#include "rttov_errorreport.interface"
private
public :: rttov_hdf_radiance2_init
public :: rttov_hdf_radiance2_rh
public :: rttov_hdf_radiance2_wh


contains


subroutine rttov_hdf_radiance2_init(x)
type(rttov_radiance2),intent(inout)::x

  nullify(x%UPCLEAR)
  nullify(x%DNCLEAR)
  nullify(x%REFLDNCLEAR)
  nullify(x%UP)
  nullify(x%DOWN)
  nullify(x%SURF)
end subroutine

subroutine rttov_hdf_radiance2_rh(x,lun,err)
type(rttov_radiance2),intent(out)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
character(len=lensh)::sname
logical :: lext
TRY

call rttov_hdf_radiance2_init(x)

sname='UPCLEAR'
call read_array_hdf(lun,sname,err,pr1=x%UPCLEAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='DNCLEAR'
call read_array_hdf(lun,sname,err,pr1=x%DNCLEAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='REFLDNCLEAR'
call read_array_hdf(lun,sname,err,pr1=x%REFLDNCLEAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='UP'
call read_array_hdf(lun,sname,err,pr2=x%UP)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='DOWN'
call read_array_hdf(lun,sname,err,pr2=x%DOWN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='SURF'
call read_array_hdf(lun,sname,err,pr2=x%SURF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

err=0_jpim
CATCH
end subroutine

subroutine rttov_hdf_radiance2_wh(x,lun,err,compress,force_double)
type(rttov_radiance2),intent(in)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
logical,intent(in),optional::compress
logical,intent(in),optional::force_double
character(len=lensh)::sname

TRY
sname='UPCLEAR'
if(associated(x%UPCLEAR))then
  call write_array_hdf(lun,sname,&
    & 'Clear sky upwelling radiance without reflection term',&
    & err,r1=x%UPCLEAR , units = 'mw/cm-1/ster/sq.m'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='DNCLEAR'
if(associated(x%DNCLEAR))then
  call write_array_hdf(lun,sname,&
    & 'Clear sky downwelling radiance',&
    & err,r1=x%DNCLEAR , units = 'mw/cm-1/ster/sq.m'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='REFLDNCLEAR'
if(associated(x%REFLDNCLEAR))then
  call write_array_hdf(lun,sname,&
    & 'Reflected clear sky downwelling radiance NB thermal only!!',&
    & err,r1=x%REFLDNCLEAR , units = 'mw/cm-1/ster/sq.m'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='UP'
if(associated(x%UP))then
  call write_array_hdf(lun,sname,&
    & 'sum( B * dT ) above cloud upwelling radiance for each pressure level',&
    & err,r2=x%UP , units = 'mw/cm-1/ster/sq.m' ,compress=compress ,force_double=force_double)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='DOWN'
if(associated(x%DOWN))then
  call write_array_hdf(lun,sname,&
    & 'sum ( B / T**2 dT ) above cloud downwelling radiance for each pressure level',&
    & err,r2=x%DOWN , units = 'mw/cm-1/ster/sq.m' ,compress=compress ,force_double=force_double)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SURF'
if(associated(x%SURF))then
  call write_array_hdf(lun,sname,&
    & 'Radiance at surface emitted from a black cloud (levels,channels)',&
    & err,r2=x%SURF , units = 'mw/cm-1/ster/sq.m' ,compress=compress ,force_double=force_double)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

err=0_jpim
CATCH
end subroutine

end module
