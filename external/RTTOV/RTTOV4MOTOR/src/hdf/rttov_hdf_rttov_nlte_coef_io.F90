!
! Automatically generated by ./mod_rw_for_rttov_types.pl
! Do not edit
!
! Copyright:
!    This software was developed within the context of
!    the EUMETSAT Satellite Application Facility on
!    Numerical Weather Prediction (NWP SAF), under the
!    Cooperation Agreement dated 7 December 2016, between
!    EUMETSAT and the Met Office, UK, by one or more partners
!    within the NWP SAF. The partners in the NWP SAF are
!    the Met Office, ECMWF, DWD and MeteoFrance.
!
!    Copyright 2016, EUMETSAT, All Rights Reserved.
!
module rttov_hdf_rttov_nlte_coef_io
#include "throw.h"
use parkind1
!use rttov_print_mod
use rttov_hdf_mod
!use rttov_hdf_rttov_nlte_coef_def
!use rttov_hdf_rttov_nlte_coef_mem
use rttov_types

use hdf5
implicit none
#include "rttov_errorreport.interface"
private
public :: rttov_hdf_rttov_nlte_coef_init
public :: rttov_hdf_rttov_nlte_coef_rh
public :: rttov_hdf_rttov_nlte_coef_wh


contains


subroutine rttov_hdf_rttov_nlte_coef_init(x)
type(rttov_nlte_coef),intent(inout)::x

  nullify(x%COEF)
  nullify(x%SOL_ZEN_ANGLE)
  nullify(x%COS_SOL)
  nullify(x%SEC_SAT)
  nullify(x%SAT_ZEN_ANGLE)
  x%NCOEF=0_jpim
  x%NSOL=0_jpim
  x%NSAT=0_jpim
  x%NCHAN=0_jpim
  x%START_CHAN=0_jpim
  x%MAX_SAT_ANGLE=0._jprb
end subroutine

subroutine rttov_hdf_rttov_nlte_coef_rh(x,lun,err)
type(rttov_nlte_coef),intent(out)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
character(len=lensh)::sname
logical :: lext
TRY

call rttov_hdf_rttov_nlte_coef_init(x)

sname='COEF'
call read_array_hdf(lun,sname,err,pr4=x%COEF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='SOL_ZEN_ANGLE'
call read_array_hdf(lun,sname,err,pr1=x%SOL_ZEN_ANGLE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))


sname='SEC_SAT'
call read_array_hdf(lun,sname,err,pr1=x%SEC_SAT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))


sname='NCOEF'
call read_array_hdf(lun,sname,err,i0=x%NCOEF)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='NSOL'
call read_array_hdf(lun,sname,err,i0=x%NSOL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='NSAT'
call read_array_hdf(lun,sname,err,i0=x%NSAT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='NCHAN'
call read_array_hdf(lun,sname,err,i0=x%NCHAN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='START_CHAN'
call read_array_hdf(lun,sname,err,i0=x%START_CHAN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='MAX_SAT_ANGLE'
call read_array_hdf(lun,sname,err,r0=x%MAX_SAT_ANGLE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

err=0_jpim
CATCH
end subroutine

subroutine rttov_hdf_rttov_nlte_coef_wh(x,lun,err,compress,force_double)
type(rttov_nlte_coef),intent(in)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
logical,intent(in),optional::compress
logical,intent(in),optional::force_double
character(len=lensh)::sname

TRY
sname='COEF'
if(associated(x%COEF))then
  call write_array_hdf(lun,sname,&
    & 'Coefficients for NLTE',&
    & err,r4=x%COEF , units = 'n/a' ,compress=compress,compdims=(/-1,-1,-1,1/) ,force_double=force_double)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SOL_ZEN_ANGLE'
if(associated(x%SOL_ZEN_ANGLE))then
  call write_array_hdf(lun,sname,&
    & 'Reference Solar Zenith Angles',&
    & err,r1=x%SOL_ZEN_ANGLE , units = 'degrees'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif


sname='SEC_SAT'
if(associated(x%SEC_SAT))then
  call write_array_hdf(lun,sname,&
    & 'Reference Satellite Zenith Secants',&
    & err,r1=x%SEC_SAT , units = 'n/a'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif


sname='NCOEF'
call write_array_hdf(lun,sname,&
  & '',&
  & err,i0=x%NCOEF   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='NSOL'
call write_array_hdf(lun,sname,&
  & '',&
  & err,i0=x%NSOL   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='NSAT'
call write_array_hdf(lun,sname,&
  & '',&
  & err,i0=x%NSAT   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='NCHAN'
call write_array_hdf(lun,sname,&
  & '',&
  & err,i0=x%NCHAN   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='START_CHAN'
call write_array_hdf(lun,sname,&
  & '',&
  & err,i0=x%START_CHAN   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='MAX_SAT_ANGLE'
call write_array_hdf(lun,sname,&
  & '',&
  & err,r0=x%MAX_SAT_ANGLE   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

err=0_jpim
CATCH
end subroutine

end module
