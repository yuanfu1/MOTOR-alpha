!
! Automatically generated by ./mod_rw_for_rttov_types.pl
! Do not edit
!
! Copyright:
!    This software was developed within the context of
!    the EUMETSAT Satellite Application Facility on
!    Numerical Weather Prediction (NWP SAF), under the
!    Cooperation Agreement dated 7 December 2016, between
!    EUMETSAT and the Met Office, UK, by one or more partners
!    within the NWP SAF. The partners in the NWP SAF are
!    the Met Office, ECMWF, DWD and MeteoFrance.
!
!    Copyright 2016, EUMETSAT, All Rights Reserved.
!
module rttov_hdf_skin_io
#include "throw.h"
use parkind1
!use rttov_print_mod
use rttov_hdf_mod
!use rttov_hdf_skin_def
!use rttov_hdf_skin_mem
use rttov_types

use hdf5
implicit none
#include "rttov_errorreport.interface"
private
public :: rttov_hdf_skin_init
public :: rttov_hdf_skin_rh
public :: rttov_hdf_skin_wh


contains


subroutine rttov_hdf_skin_init(x)
type(rttov_skin),intent(inout)::x

  x%SURFTYPE=0_jpim
  x%WATERTYPE=1_jpim
  x%T=0._jprb
  x%SNOW_FRACTION=0._jprb
  x%SOIL_MOISTURE=0._jprb
  x%SALINITY=35._jprb
  x%FOAM_FRACTION=0._jprb
  x%FASTEM=0._jprb
end subroutine

subroutine rttov_hdf_skin_rh(x,lun,err)
type(rttov_skin),intent(out)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
character(len=lensh)::sname
logical :: lext
TRY

call rttov_hdf_skin_init(x)

sname='SURFTYPE'
call read_array_hdf(lun,sname,err,i0=x%SURFTYPE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='WATERTYPE'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%WATERTYPE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='T'
call read_array_hdf(lun,sname,err,r0=x%T)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='SNOW_FRACTION'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%SNOW_FRACTION)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SOIL_MOISTURE'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%SOIL_MOISTURE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SALINITY'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%SALINITY)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='FOAM_FRACTION'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%FOAM_FRACTION)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='FASTEM'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r1=x%FASTEM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

err=0_jpim
CATCH
end subroutine

subroutine rttov_hdf_skin_wh(x,lun,err,compress,force_double)
type(rttov_skin),intent(in)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
logical,intent(in),optional::compress
logical,intent(in),optional::force_double
character(len=lensh)::sname

TRY
sname='SURFTYPE'
call write_array_hdf(lun,sname,&
  & '0=land, 1=sea, 2=sea-ice',&
  & err,i0=x%SURFTYPE   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='WATERTYPE'
call write_array_hdf(lun,sname,&
  & '0=fresh water, 1=ocean water',&
  & err,i0=x%WATERTYPE   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='T'
call write_array_hdf(lun,sname,&
  & 'Radiative skin temperature (K)',&
  & err,r0=x%T , units = 'K'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SNOW_FRACTION'
call write_array_hdf(lun,sname,&
  & 'Surface snow coverage fraction (0-1). Used only by IR emissivity atlas',&
  & err,r0=x%SNOW_FRACTION , units = '0:1'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SOIL_MOISTURE'
call write_array_hdf(lun,sname,&
  & 'soil moisture',&
  & err,r0=x%SOIL_MOISTURE , units = 'm^3/m^3'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SALINITY'
call write_array_hdf(lun,sname,&
  & 'Practical salinity unit %o - FASTEM-4/5/6 only',&
  & err,r0=x%SALINITY   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FOAM_FRACTION'
call write_array_hdf(lun,sname,&
  & 'Ocean foam coverage fraction (0-1). Used by FASTEM when supply_foam_fraction option is TRUE ',&
  & err,r0=x%FOAM_FRACTION , units = '0:1'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='FASTEM'
call write_array_hdf(lun,sname,&
  & 'Land/sea-ice surface parameters for fastem',&
  & err,r1=x%FASTEM   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

err=0_jpim
CATCH
end subroutine

end module
