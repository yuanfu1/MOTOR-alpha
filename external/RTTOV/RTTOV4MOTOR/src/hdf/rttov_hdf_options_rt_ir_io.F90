!
! Automatically generated by ./mod_rw_for_rttov_types.pl
! Do not edit
!
! Copyright:
!    This software was developed within the context of
!    the EUMETSAT Satellite Application Facility on
!    Numerical Weather Prediction (NWP SAF), under the
!    Cooperation Agreement dated 7 December 2016, between
!    EUMETSAT and the Met Office, UK, by one or more partners
!    within the NWP SAF. The partners in the NWP SAF are
!    the Met Office, ECMWF, DWD and MeteoFrance.
!
!    Copyright 2016, EUMETSAT, All Rights Reserved.
!
module rttov_hdf_options_rt_ir_io
#include "throw.h"
use parkind1
!use rttov_print_mod
use rttov_hdf_mod
!use rttov_hdf_options_rt_ir_def
!use rttov_hdf_options_rt_ir_mem
use rttov_types

use hdf5
implicit none
#include "rttov_errorreport.interface"
private
public :: rttov_hdf_options_rt_ir_init
public :: rttov_hdf_options_rt_ir_rh
public :: rttov_hdf_options_rt_ir_wh


contains


subroutine rttov_hdf_options_rt_ir_init(x)
type(rttov_opts_rt_ir),intent(inout)::x

  x%CLDCOL_THRESHOLD=-1.0_jprb
  x%CLOUD_OVERLAP=1_jpim
  x%CC_LOW_CLOUD_TOP=750._jprb
  x%SOLAR_SEA_BRDF_MODEL=1_jpim
  x%IR_SEA_EMIS_MODEL=1_jpim
  x%ADDSOLAR=.FALSE.
  x%RAYLEIGH_MAX_WAVELENGTH=2._jprb
  x%RAYLEIGH_MIN_PRESSURE=0._jprb
  x%RAYLEIGH_SINGLE_SCATT=.TRUE.
  x%ADDAEROSL=.FALSE.
  x%USER_AER_OPT_PARAM=.FALSE.
  x%ADDCLOUDS=.FALSE.
  x%USER_CLD_OPT_PARAM=.FALSE.
  x%GRID_BOX_AVG_CLOUD=.FALSE.
  x%IR_SCATT_MODEL=2_jpim
  x%VIS_SCATT_MODEL=1_jpim
  x%DOM_NSTREAMS=8_jpim
  x%DOM_ACCURACY=0._jprb
  x%DOM_OPDEP_THRESHOLD=0._jprb
  x%DOM_RAYLEIGH=.FALSE.
  x%DO_NLTE_CORRECTION=.FALSE.
end subroutine

subroutine rttov_hdf_options_rt_ir_rh(x,lun,err)
type(rttov_opts_rt_ir),intent(out)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
character(len=lensh)::sname
logical :: lext
TRY

call rttov_hdf_options_rt_ir_init(x)


sname='CLDCOL_THRESHOLD'
call read_array_hdf(lun,sname,err,r0=x%CLDCOL_THRESHOLD)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='CLOUD_OVERLAP'
call read_array_hdf(lun,sname,err,i0=x%CLOUD_OVERLAP)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='CC_LOW_CLOUD_TOP'
call read_array_hdf(lun,sname,err,r0=x%CC_LOW_CLOUD_TOP)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='SOLAR_SEA_BRDF_MODEL'
call read_array_hdf(lun,sname,err,i0=x%SOLAR_SEA_BRDF_MODEL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='IR_SEA_EMIS_MODEL'
call read_array_hdf(lun,sname,err,i0=x%IR_SEA_EMIS_MODEL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ADDSOLAR'
call read_array_hdf(lun,sname,err,l0=x%ADDSOLAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='RAYLEIGH_MAX_WAVELENGTH'
call read_array_hdf(lun,sname,err,r0=x%RAYLEIGH_MAX_WAVELENGTH)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='RAYLEIGH_MIN_PRESSURE'
call read_array_hdf(lun,sname,err,r0=x%RAYLEIGH_MIN_PRESSURE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='RAYLEIGH_SINGLE_SCATT'
call read_array_hdf(lun,sname,err,l0=x%RAYLEIGH_SINGLE_SCATT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ADDAEROSL'
call read_array_hdf(lun,sname,err,l0=x%ADDAEROSL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='USER_AER_OPT_PARAM'
call read_array_hdf(lun,sname,err,l0=x%USER_AER_OPT_PARAM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ADDCLOUDS'
call read_array_hdf(lun,sname,err,l0=x%ADDCLOUDS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='USER_CLD_OPT_PARAM'
call read_array_hdf(lun,sname,err,l0=x%USER_CLD_OPT_PARAM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='GRID_BOX_AVG_CLOUD'
call read_array_hdf(lun,sname,err,l0=x%GRID_BOX_AVG_CLOUD)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='IR_SCATT_MODEL'
call read_array_hdf(lun,sname,err,i0=x%IR_SCATT_MODEL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='VIS_SCATT_MODEL'
call read_array_hdf(lun,sname,err,i0=x%VIS_SCATT_MODEL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='DOM_NSTREAMS'
call read_array_hdf(lun,sname,err,i0=x%DOM_NSTREAMS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='DOM_ACCURACY'
call read_array_hdf(lun,sname,err,r0=x%DOM_ACCURACY)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='DOM_OPDEP_THRESHOLD'
call read_array_hdf(lun,sname,err,r0=x%DOM_OPDEP_THRESHOLD)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='DOM_RAYLEIGH'
call read_array_hdf(lun,sname,err,l0=x%DOM_RAYLEIGH)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='DO_NLTE_CORRECTION'
call read_array_hdf(lun,sname,err,l0=x%DO_NLTE_CORRECTION)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

err=0_jpim
CATCH
end subroutine

subroutine rttov_hdf_options_rt_ir_wh(x,lun,err,compress,force_double)
type(rttov_opts_rt_ir),intent(in)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
logical,intent(in),optional::compress
logical,intent(in),optional::force_double
character(len=lensh)::sname

TRY

sname='CLDCOL_THRESHOLD'
call write_array_hdf(lun,sname,&
  & 'Cloud column weight threshold, recommended to set this negative for TL/AD/K',&
  & err,r0=x%CLDCOL_THRESHOLD   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='CLOUD_OVERLAP'
call write_array_hdf(lun,sname,&
  & 'Select cloud overlap scheme: 1=>max/random, 2=>simple scheme for high-peaking channels',&
  & err,i0=x%CLOUD_OVERLAP   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='CC_LOW_CLOUD_TOP'
call write_array_hdf(lun,sname,&
  & 'Upper pressure limit for simple cloud overlap option (hPa)',&
  & err,r0=x%CC_LOW_CLOUD_TOP   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SOLAR_SEA_BRDF_MODEL'
call write_array_hdf(lun,sname,&
  & 'Solar sea BRDF model; valid range: 1-2.',&
  & err,i0=x%SOLAR_SEA_BRDF_MODEL   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='IR_SEA_EMIS_MODEL'
call write_array_hdf(lun,sname,&
  & 'IR sea emissivity model; valid range: 1-2.',&
  & err,i0=x%IR_SEA_EMIS_MODEL   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ADDSOLAR'
call write_array_hdf(lun,sname,&
  & 'Enable solar calculations',&
  & err,l0=x%ADDSOLAR   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='RAYLEIGH_MAX_WAVELENGTH'
call write_array_hdf(lun,sname,&
  & 'Ignore Rayleigh scattering in channels with wavelengths larger than this (microns)',&
  & err,r0=x%RAYLEIGH_MAX_WAVELENGTH   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='RAYLEIGH_MIN_PRESSURE'
call write_array_hdf(lun,sname,&
  & 'Ignore Rayleigh scattering at pressure levels below this (hPa)',&
  & err,r0=x%RAYLEIGH_MIN_PRESSURE   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='RAYLEIGH_SINGLE_SCATT'
call write_array_hdf(lun,sname,&
  & 'Enable Rayleigh single-scattering calculations',&
  & err,l0=x%RAYLEIGH_SINGLE_SCATT   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ADDAEROSL'
call write_array_hdf(lun,sname,&
  & 'Account for scattering due to aerosols',&
  & err,l0=x%ADDAEROSL   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='USER_AER_OPT_PARAM'
call write_array_hdf(lun,sname,&
  & 'User input for aerosols optical parameters',&
  & err,l0=x%USER_AER_OPT_PARAM   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ADDCLOUDS'
call write_array_hdf(lun,sname,&
  & 'account for scattering due to clouds',&
  & err,l0=x%ADDCLOUDS   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='USER_CLD_OPT_PARAM'
call write_array_hdf(lun,sname,&
  & 'User input for cloud optical parameters',&
  & err,l0=x%USER_CLD_OPT_PARAM   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='GRID_BOX_AVG_CLOUD'
call write_array_hdf(lun,sname,&
  & 'Switch to supply grid-box average or layer-cloudy-fraction cloud concentration',&
  & err,l0=x%GRID_BOX_AVG_CLOUD   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='IR_SCATT_MODEL'
call write_array_hdf(lun,sname,&
  & 'IR scattering model: 1=>DOM, 2=>Chou-scaling',&
  & err,i0=x%IR_SCATT_MODEL   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='VIS_SCATT_MODEL'
call write_array_hdf(lun,sname,&
  & 'Visible/near-IR scattering model: 1=>DOM, 2=>single-scattering, 3=>MFASIS',&
  & err,i0=x%VIS_SCATT_MODEL   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='DOM_NSTREAMS'
call write_array_hdf(lun,sname,&
  & 'DOM nstreams parameter, number of streams (discrete ordinates) to use',&
  & err,i0=x%DOM_NSTREAMS   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='DOM_ACCURACY'
call write_array_hdf(lun,sname,&
  & 'DOM accuracy parameter, determines convergence criterion for azimuthal loop',&
  & err,r0=x%DOM_ACCURACY   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='DOM_OPDEP_THRESHOLD'
call write_array_hdf(lun,sname,&
  & 'DOM absorption optical depth threshold below which layers are ignored; not applied if value is <= 0.',&
  & err,r0=x%DOM_OPDEP_THRESHOLD   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='DOM_RAYLEIGH'
call write_array_hdf(lun,sname,&
  & 'Include Rayleigh scattering in VIS/NIR DOM simulations',&
  & err,l0=x%DOM_RAYLEIGH   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='DO_NLTE_CORRECTION'
call write_array_hdf(lun,sname,&
  & 'Enable Non Local Thermal Equilibrium (NLTE) calculations',&
  & err,l0=x%DO_NLTE_CORRECTION   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

err=0_jpim
CATCH
end subroutine

end module
