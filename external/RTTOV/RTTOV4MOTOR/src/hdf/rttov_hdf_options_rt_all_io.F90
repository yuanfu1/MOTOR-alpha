!
! Automatically generated by ./mod_rw_for_rttov_types.pl
! Do not edit
!
! Copyright:
!    This software was developed within the context of
!    the EUMETSAT Satellite Application Facility on
!    Numerical Weather Prediction (NWP SAF), under the
!    Cooperation Agreement dated 7 December 2016, between
!    EUMETSAT and the Met Office, UK, by one or more partners
!    within the NWP SAF. The partners in the NWP SAF are
!    the Met Office, ECMWF, DWD and MeteoFrance.
!
!    Copyright 2016, EUMETSAT, All Rights Reserved.
!
module rttov_hdf_options_rt_all_io
#include "throw.h"
use parkind1
!use rttov_print_mod
use rttov_hdf_mod
!use rttov_hdf_options_rt_all_def
!use rttov_hdf_options_rt_all_mem
use rttov_types

use hdf5
implicit none
#include "rttov_errorreport.interface"
private
public :: rttov_hdf_options_rt_all_init
public :: rttov_hdf_options_rt_all_rh
public :: rttov_hdf_options_rt_all_wh


contains


subroutine rttov_hdf_options_rt_all_init(x)
type(rttov_opts_rt_all),intent(inout)::x

  x%OZONE_DATA=.FALSE.
  x%CO2_DATA=.FALSE.
  x%N2O_DATA=.FALSE.
  x%CO_DATA=.FALSE.
  x%CH4_DATA=.FALSE.
  x%SO2_DATA=.FALSE.
  x%SWITCHRAD=.FALSE.
  x%ADDREFRAC=.FALSE.
  x%PLANE_PARALLEL=.FALSE.
  x%USE_T2M_OPDEP=.TRUE.
  x%USE_Q2M=.TRUE.
  x%DO_LAMBERTIAN=.FALSE.
  x%LAMBERTIAN_FIXED_ANGLE=.TRUE.
  x%RAD_DOWN_LIN_TAU=.TRUE.
  x%DTAU_TEST=.TRUE.
end subroutine

subroutine rttov_hdf_options_rt_all_rh(x,lun,err)
type(rttov_opts_rt_all),intent(out)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
character(len=lensh)::sname
logical :: lext
TRY

call rttov_hdf_options_rt_all_init(x)

sname='OZONE_DATA'
call read_array_hdf(lun,sname,err,l0=x%OZONE_DATA)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='CO2_DATA'
call read_array_hdf(lun,sname,err,l0=x%CO2_DATA)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='N2O_DATA'
call read_array_hdf(lun,sname,err,l0=x%N2O_DATA)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='CO_DATA'
call read_array_hdf(lun,sname,err,l0=x%CO_DATA)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='CH4_DATA'
call read_array_hdf(lun,sname,err,l0=x%CH4_DATA)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='SO2_DATA'
call read_array_hdf(lun,sname,err,l0=x%SO2_DATA)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='SWITCHRAD'
call read_array_hdf(lun,sname,err,l0=x%SWITCHRAD)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='ADDREFRAC'
call read_array_hdf(lun,sname,err,l0=x%ADDREFRAC)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='PLANE_PARALLEL'
call read_array_hdf(lun,sname,err,l0=x%PLANE_PARALLEL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='USE_T2M_OPDEP'
call read_array_hdf(lun,sname,err,l0=x%USE_T2M_OPDEP)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='USE_Q2M'
call read_array_hdf(lun,sname,err,l0=x%USE_Q2M)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='DO_LAMBERTIAN'
call read_array_hdf(lun,sname,err,l0=x%DO_LAMBERTIAN)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LAMBERTIAN_FIXED_ANGLE'
call read_array_hdf(lun,sname,err,l0=x%LAMBERTIAN_FIXED_ANGLE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='RAD_DOWN_LIN_TAU'
call read_array_hdf(lun,sname,err,l0=x%RAD_DOWN_LIN_TAU)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='DTAU_TEST'
call read_array_hdf(lun,sname,err,l0=x%DTAU_TEST)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

err=0_jpim
CATCH
end subroutine

subroutine rttov_hdf_options_rt_all_wh(x,lun,err,compress,force_double)
type(rttov_opts_rt_all),intent(in)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
logical,intent(in),optional::compress
logical,intent(in),optional::force_double
character(len=lensh)::sname

TRY
sname='OZONE_DATA'
call write_array_hdf(lun,sname,&
  & 'Profile contains Ozone data',&
  & err,l0=x%OZONE_DATA   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='CO2_DATA'
call write_array_hdf(lun,sname,&
  & 'Profile contains CO2 data',&
  & err,l0=x%CO2_DATA   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='N2O_DATA'
call write_array_hdf(lun,sname,&
  & 'Profile contains N2O data',&
  & err,l0=x%N2O_DATA   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='CO_DATA'
call write_array_hdf(lun,sname,&
  & 'Profile contains CO data',&
  & err,l0=x%CO_DATA   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='CH4_DATA'
call write_array_hdf(lun,sname,&
  & 'Profile contains CH4 data',&
  & err,l0=x%CH4_DATA   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SO2_DATA'
call write_array_hdf(lun,sname,&
  & 'Profile contains SO2 data',&
  & err,l0=x%SO2_DATA   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SWITCHRAD'
call write_array_hdf(lun,sname,&
  & 'Determines input perturbation for AD/K: if true, radiance_k%bt is used, otherwise radiance_k%total',&
  & err,l0=x%SWITCHRAD   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ADDREFRAC'
call write_array_hdf(lun,sname,&
  & 'RTTOV calculations account for atmospheric refraction',&
  & err,l0=x%ADDREFRAC   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='PLANE_PARALLEL'
call write_array_hdf(lun,sname,&
  & 'RTTOV calculations performed for strictly plane parallel atmosphere (no curvature or refraction)',&
  & err,l0=x%PLANE_PARALLEL   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='USE_T2M_OPDEP'
call write_array_hdf(lun,sname,&
  & 'Activate use of surface temperature in optical depth calculation',&
  & err,l0=x%USE_T2M_OPDEP   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='USE_Q2M'
call write_array_hdf(lun,sname,&
  & 'Activate use of surface humidity',&
  & err,l0=x%USE_Q2M   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='DO_LAMBERTIAN'
call write_array_hdf(lun,sname,&
  & 'Activate treatment of surface as Lambertian instead of specular reflector for downwelling emitted radiation',&
  & err,l0=x%DO_LAMBERTIAN   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='LAMBERTIAN_FIXED_ANGLE'
call write_array_hdf(lun,sname,&
  & 'Select between fixed/parameterised effective angle for Lambertian option',&
  & err,l0=x%LAMBERTIAN_FIXED_ANGLE   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='RAD_DOWN_LIN_TAU'
call write_array_hdf(lun,sname,&
  & 'Use linear-in-tau (true) or layer-average (false) radiance for downwelling calculations',&
  & err,l0=x%RAD_DOWN_LIN_TAU   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='DTAU_TEST'
call write_array_hdf(lun,sname,&
  & 'Apply dtau test in transmit/integrate calculations',&
  & err,l0=x%DTAU_TEST   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

err=0_jpim
CATCH
end subroutine

end module
