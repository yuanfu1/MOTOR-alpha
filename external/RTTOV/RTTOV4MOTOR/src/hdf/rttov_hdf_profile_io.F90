!
! Automatically generated by ./mod_rw_for_rttov_types.pl
! Do not edit
!
! Copyright:
!    This software was developed within the context of
!    the EUMETSAT Satellite Application Facility on
!    Numerical Weather Prediction (NWP SAF), under the
!    Cooperation Agreement dated 7 December 2016, between
!    EUMETSAT and the Met Office, UK, by one or more partners
!    within the NWP SAF. The partners in the NWP SAF are
!    the Met Office, ECMWF, DWD and MeteoFrance.
!
!    Copyright 2016, EUMETSAT, All Rights Reserved.
!
module rttov_hdf_profile_io
#include "throw.h"
use parkind1
!use rttov_print_mod
use rttov_hdf_mod
!use rttov_hdf_profile_def
!use rttov_hdf_profile_mem
use rttov_types

use hdf5
implicit none
#include "rttov_errorreport.interface"
private
public :: rttov_hdf_profile_init
public :: rttov_hdf_profile_rh
public :: rttov_hdf_profile_wh


contains


subroutine rttov_hdf_profile_init(x)
type(rttov_profile),intent(inout)::x

  x%ID=''
  x%DATE=0_jpim
  x%TIME=0_jpim
  x%NLEVELS=0_jpim
  x%NLAYERS=0_jpim
  x%GAS_UNITS=0_jpim
  x%MMR_CLDAER=.TRUE.
  nullify(x%P)
  nullify(x%T)
  nullify(x%Q)
  nullify(x%O3)
  nullify(x%CO2)
  nullify(x%N2O)
  nullify(x%CO)
  nullify(x%CH4)
  nullify(x%SO2)
  nullify(x%CLW)
  nullify(x%AEROSOLS)
  nullify(x%CLOUD)
  nullify(x%CFRAC)
  nullify(x%CLWDE)
  x%CLWDE_PARAM=1_jpim
  x%CLW_SCHEME=-1_jpim
  nullify(x%ICEDE)
  x%ICEDE_PARAM=-1_jpim
  x%ICE_SCHEME=-1_jpim
  x%ZENANGLE=0._jprb
  x%AZANGLE=0._jprb
  x%SUNZENANGLE=0._jprb
  x%SUNAZANGLE=0._jprb
  x%ELEVATION=0._jprb
  x%LATITUDE=0._jprb
  x%LONGITUDE=0._jprb
  x%BE=0._jprb
  x%COSBK=0._jprb
  x%CTP=500._jprb
  x%CFRACTION=0._jprb
end subroutine

subroutine rttov_hdf_profile_rh(x,lun,err)
type(rttov_profile),intent(out)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
character(len=lensh)::sname
logical :: lext
TRY

call rttov_hdf_profile_init(x)

sname='ID'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,c0=x%ID)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='DATE'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i1=x%DATE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='TIME'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i1=x%TIME)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='NLEVELS'
call read_array_hdf(lun,sname,err,i0=x%NLEVELS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='NLAYERS'
call read_array_hdf(lun,sname,err,i0=x%NLAYERS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='GAS_UNITS'
call read_array_hdf(lun,sname,err,i0=x%GAS_UNITS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='MMR_CLDAER'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,l0=x%MMR_CLDAER)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='P'
call read_array_hdf(lun,sname,err,pr1=x%P)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='T'
call read_array_hdf(lun,sname,err,pr1=x%T)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='Q'
call read_array_hdf(lun,sname,err,pr1=x%Q)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='O3'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%O3)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CO2'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%CO2)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='N2O'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%N2O)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CO'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%CO)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CH4'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%CH4)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SO2'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%SO2)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CLW'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%CLW)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='AEROSOLS'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%AEROSOLS)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CLOUD'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr2=x%CLOUD)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CFRAC'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%CFRAC)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CLWDE'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%CLWDE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CLWDE_PARAM'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%CLWDE_PARAM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CLW_SCHEME'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%CLW_SCHEME)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='ICEDE'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,pr1=x%ICEDE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='ICEDE_PARAM'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%ICEDE_PARAM)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='ICE_SCHEME'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,i0=x%ICE_SCHEME)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif



sname='ZENANGLE'
call read_array_hdf(lun,sname,err,r0=x%ZENANGLE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='AZANGLE'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%AZANGLE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SUNZENANGLE'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%SUNZENANGLE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='SUNAZANGLE'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%SUNAZANGLE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='ELEVATION'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%ELEVATION)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='LATITUDE'
call read_array_hdf(lun,sname,err,r0=x%LATITUDE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='LONGITUDE'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%LONGITUDE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='BE'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%BE)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='COSBK'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%COSBK)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CTP'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%CTP)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

sname='CFRACTION'
call h5lexists_f( lun, sname, lext, err )
if( lext ) then
call read_array_hdf(lun,sname,err,r0=x%CFRACTION)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))
endif

err=0_jpim
CATCH
end subroutine

subroutine rttov_hdf_profile_wh(x,lun,err,compress,force_double)
type(rttov_profile),intent(in)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
logical,intent(in),optional::compress
logical,intent(in),optional::force_double
character(len=lensh)::sname

TRY
sname='ID'
call write_array_hdf(lun,sname,&
  & 'User may give text ID to each profile',&
  & err,c0=x%ID   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='DATE'
call write_array_hdf(lun,sname,&
  & 'Year Month Day',&
  & err,i1=x%DATE   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='TIME'
call write_array_hdf(lun,sname,&
  & 'Hour Minute Second',&
  & err,i1=x%TIME   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='NLEVELS'
call write_array_hdf(lun,sname,&
  & 'Number of atmospheric levels',&
  & err,i0=x%NLEVELS   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='NLAYERS'
call write_array_hdf(lun,sname,&
  & 'Number of atmospheric layers',&
  & err,i0=x%NLAYERS   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='GAS_UNITS'
call write_array_hdf(lun,sname,&
  & 'Units for gas profiles',&
  & err,i0=x%GAS_UNITS   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='MMR_CLDAER'
call write_array_hdf(lun,sname,&
  & 'Units for cld/aer profiles: True => kg/kg; False => cm-3 (aer), g/m3 (cld)',&
  & err,l0=x%MMR_CLDAER   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='P'
if(associated(x%P))then
  call write_array_hdf(lun,sname,&
    & 'Pressure',&
    & err,r1=x%P , units = 'hPa'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='T'
if(associated(x%T))then
  call write_array_hdf(lun,sname,&
    & 'Temperature',&
    & err,r1=x%T , units = 'K'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='Q'
if(associated(x%Q))then
  call write_array_hdf(lun,sname,&
    & 'Water vapour',&
    & err,r1=x%Q , units = 'ppmv or kg/kg'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='O3'
if(associated(x%O3))then
  call write_array_hdf(lun,sname,&
    & 'Ozone',&
    & err,r1=x%O3 , units = 'ppmv or kg/kg'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CO2'
if(associated(x%CO2))then
  call write_array_hdf(lun,sname,&
    & 'Carbon dioxide',&
    & err,r1=x%CO2 , units = 'ppmv or kg/kg'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='N2O'
if(associated(x%N2O))then
  call write_array_hdf(lun,sname,&
    & 'N2O',&
    & err,r1=x%N2O , units = 'ppmv or kg/kg'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CO'
if(associated(x%CO))then
  call write_array_hdf(lun,sname,&
    & 'CO',&
    & err,r1=x%CO , units = 'ppmv or kg/kg'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CH4'
if(associated(x%CH4))then
  call write_array_hdf(lun,sname,&
    & 'CH4',&
    & err,r1=x%CH4 , units = 'ppmv or kg/kg'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='SO2'
if(associated(x%SO2))then
  call write_array_hdf(lun,sname,&
    & 'SO2',&
    & err,r1=x%SO2 , units = 'ppmv or kg/kg'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CLW'
if(associated(x%CLW))then
  call write_array_hdf(lun,sname,&
    & 'Cloud liquid water (as absorber) - MW only',&
    & err,r1=x%CLW , units = 'kg/kg'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='AEROSOLS'
if(associated(x%AEROSOLS))then
  call write_array_hdf(lun,sname,&
    & 'Aerosols - VIS/IR only',&
    & err,r2=x%AEROSOLS , units = 'kg/kg or number density in cm-3' ,compress=compress )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CLOUD'
if(associated(x%CLOUD))then
  call write_array_hdf(lun,sname,&
    & 'Cloud water/ice - VIS/IR only',&
    & err,r2=x%CLOUD , units = 'kg/kg or g/m3' ,compress=compress )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CFRAC'
if(associated(x%CFRAC))then
  call write_array_hdf(lun,sname,&
    & 'Cloud fractional cover (0-1) - VIS/IR only',&
    & err,r1=x%CFRAC , units = '0:1'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CLWDE'
if(associated(x%CLWDE))then
  call write_array_hdf(lun,sname,&
    & 'Cloud liquid water particle diameter - VIS/IR only',&
    & err,r1=x%CLWDE , units = 'microns'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CLWDE_PARAM'
call write_array_hdf(lun,sname,&
  & 'Scheme for CLW to eff diameter - VIS/IR only, 1=Martin et al',&
  & err,i0=x%CLWDE_PARAM   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='CLW_SCHEME'
call write_array_hdf(lun,sname,&
  & 'Choose the liquid water cloud scheme - VIS/IR only, 1=OPAC particle types; 2=Deff scheme',&
  & err,i0=x%CLW_SCHEME   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ICEDE'
if(associated(x%ICEDE))then
  call write_array_hdf(lun,sname,&
    & 'Ice crystals diameter - VIS/IR only',&
    & err,r1=x%ICEDE , units = 'microns'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='ICEDE_PARAM'
call write_array_hdf(lun,sname,&
  & 'Scheme for IWC to eff diameter - VIS/IR only, Dg 1=Ou and Liou; 2=Wyser et al; 3=Boudala et al; 4=McFarquhar et al',&
  & err,i0=x%ICEDE_PARAM   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ICE_SCHEME'
call write_array_hdf(lun,sname,&
  & 'Choose the ice cloud scheme - VIS/IR only, 1=Baum ice database; 2=Baran 2014 scheme; 3=Baran 2018 scheme',&
  & err,i0=x%ICE_SCHEME   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))



sname='ZENANGLE'
call write_array_hdf(lun,sname,&
  & 'Satellite zenith angle',&
  & err,r0=x%ZENANGLE , units = 'degree'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='AZANGLE'
call write_array_hdf(lun,sname,&
  & 'Satellite azimuth angle',&
  & err,r0=x%AZANGLE , units = 'degree (0-360 deg; east=90)'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SUNZENANGLE'
call write_array_hdf(lun,sname,&
  & 'Sun zenith angle',&
  & err,r0=x%SUNZENANGLE , units = 'degree'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='SUNAZANGLE'
call write_array_hdf(lun,sname,&
  & 'Sun azimuth angle',&
  & err,r0=x%SUNAZANGLE , units = 'degree (0-360 deg; east=90)'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='ELEVATION'
call write_array_hdf(lun,sname,&
  & 'Surface elevaton',&
  & err,r0=x%ELEVATION , units = 'km'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='LATITUDE'
call write_array_hdf(lun,sname,&
  & 'Latitude',&
  & err,r0=x%LATITUDE , units = 'degree'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='LONGITUDE'
call write_array_hdf(lun,sname,&
  & 'Longitude',&
  & err,r0=x%LONGITUDE , units = 'degree (0-360)'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='BE'
call write_array_hdf(lun,sname,&
  & 'Earth magnetic field strength',&
  & err,r0=x%BE , units = 'Gauss'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='COSBK'
call write_array_hdf(lun,sname,&
  & 'Cosine of the angle between the Earth magnetic field and wave propagation direction',&
  & err,r0=x%COSBK   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='CTP'
call write_array_hdf(lun,sname,&
  & 'Black body cloud top pressure',&
  & err,r0=x%CTP , units = 'hPa'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='CFRACTION'
call write_array_hdf(lun,sname,&
  & 'Black body cloud fraction (0-1), 1 for 100% cloud cover',&
  & err,r0=x%CFRACTION , units = '0:1'  )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

err=0_jpim
CATCH
end subroutine

end module
