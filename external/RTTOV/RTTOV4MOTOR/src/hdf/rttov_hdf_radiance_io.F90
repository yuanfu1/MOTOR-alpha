!
! Automatically generated by ./mod_rw_for_rttov_types.pl
! Do not edit
!
! Copyright:
!    This software was developed within the context of
!    the EUMETSAT Satellite Application Facility on
!    Numerical Weather Prediction (NWP SAF), under the
!    Cooperation Agreement dated 7 December 2016, between
!    EUMETSAT and the Met Office, UK, by one or more partners
!    within the NWP SAF. The partners in the NWP SAF are
!    the Met Office, ECMWF, DWD and MeteoFrance.
!
!    Copyright 2016, EUMETSAT, All Rights Reserved.
!
module rttov_hdf_radiance_io
#include "throw.h"
use parkind1
!use rttov_print_mod
use rttov_hdf_mod
!use rttov_hdf_radiance_def
!use rttov_hdf_radiance_mem
use rttov_types

use hdf5
implicit none
#include "rttov_errorreport.interface"
private
public :: rttov_hdf_radiance_init
public :: rttov_hdf_radiance_rh
public :: rttov_hdf_radiance_wh


contains


subroutine rttov_hdf_radiance_init(x)
type(rttov_radiance),intent(inout)::x

  nullify(x%CLEAR)
  nullify(x%CLOUDY)
  nullify(x%TOTAL)
  nullify(x%BT)
  nullify(x%BT_CLEAR)
  nullify(x%REFL)
  nullify(x%REFL_CLEAR)
  nullify(x%OVERCAST)
  nullify(x%QUALITY)
  x%PLANE_PARALLEL=.FALSE.
  nullify(x%GEOMETRIC_HEIGHT)
end subroutine

subroutine rttov_hdf_radiance_rh(x,lun,err)
type(rttov_radiance),intent(out)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
character(len=lensh)::sname
logical :: lext
TRY

call rttov_hdf_radiance_init(x)

sname='CLEAR'
call read_array_hdf(lun,sname,err,pr1=x%CLEAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='CLOUDY'
call read_array_hdf(lun,sname,err,pr1=x%CLOUDY)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='TOTAL'
call read_array_hdf(lun,sname,err,pr1=x%TOTAL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='BT'
call read_array_hdf(lun,sname,err,pr1=x%BT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='BT_CLEAR'
call read_array_hdf(lun,sname,err,pr1=x%BT_CLEAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='REFL'
call read_array_hdf(lun,sname,err,pr1=x%REFL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='REFL_CLEAR'
call read_array_hdf(lun,sname,err,pr1=x%REFL_CLEAR)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='OVERCAST'
call read_array_hdf(lun,sname,err,pr2=x%OVERCAST)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='QUALITY'
call read_array_hdf(lun,sname,err,pi1=x%QUALITY)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='PLANE_PARALLEL'
call read_array_hdf(lun,sname,err,l0=x%PLANE_PARALLEL)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

sname='GEOMETRIC_HEIGHT'
call read_array_hdf(lun,sname,err,pr2=x%GEOMETRIC_HEIGHT)
THROWM(err.ne.0,"CANNOT READ "//trim(sname))

err=0_jpim
CATCH
end subroutine

subroutine rttov_hdf_radiance_wh(x,lun,err,compress,force_double)
type(rttov_radiance),intent(in)::x
integer(hid_t),intent(in)::lun
integer(kind=jpim),intent(out)::err
logical,intent(in),optional::compress
logical,intent(in),optional::force_double
character(len=lensh)::sname

TRY
sname='CLEAR'
if(associated(x%CLEAR))then
  call write_array_hdf(lun,sname,&
    & 'Clear sky top of atmosphere radiance (channels)',&
    & err,r1=x%CLEAR , units = 'mw/cm-1/ster/sq.m'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='CLOUDY'
if(associated(x%CLOUDY))then
  call write_array_hdf(lun,sname,&
    & 'Cloudy top of atmosphere radiance for 100% fraction for each channel at given cloud top pressure',&
    & err,r1=x%CLOUDY , units = 'mw/cm-1/ster/sq.m'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='TOTAL'
if(associated(x%TOTAL))then
  call write_array_hdf(lun,sname,&
    & 'Clear+cloudy top of atmosphere radiance for given cloud top pressure and fraction',&
    & err,r1=x%TOTAL , units = 'mw/cm-1/ster/sq.m'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='BT'
if(associated(x%BT))then
  call write_array_hdf(lun,sname,&
    & 'Brightness temp equivalent to total radiance',&
    & err,r1=x%BT , units = 'Kelvin'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='BT_CLEAR'
if(associated(x%BT_CLEAR))then
  call write_array_hdf(lun,sname,&
    & 'Brightness temp equivalent to clear radiance',&
    & err,r1=x%BT_CLEAR , units = 'Kelvin'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='REFL'
if(associated(x%REFL))then
  call write_array_hdf(lun,sname,&
    & 'Reflectance calculated from total radiance',&
    & err,r1=x%REFL , units = 'N/A'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='REFL_CLEAR'
if(associated(x%REFL_CLEAR))then
  call write_array_hdf(lun,sname,&
    & 'Reflectance calculated from clear radiance',&
    & err,r1=x%REFL_CLEAR , units = 'N/A'  )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='OVERCAST'
if(associated(x%OVERCAST))then
  call write_array_hdf(lun,sname,&
    & 'Overcast radiance at given cloud top  (layers,channels)',&
    & err,r2=x%OVERCAST , units = 'mw/cm-1/ster/sq.m' ,compress=compress ,force_double=force_double)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='QUALITY'
if(associated(x%QUALITY))then
  call write_array_hdf(lun,sname,&
    & 'Quality flag for each simulated radiance, zero implies no problem',&
    & err,i1=x%QUALITY   )
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

sname='PLANE_PARALLEL'
call write_array_hdf(lun,sname,&
  & 'Flag to indicate whether atmosphere was treated as strictly plane-parallel',&
  & err,l0=x%PLANE_PARALLEL   )
THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))

sname='GEOMETRIC_HEIGHT'
if(associated(x%GEOMETRIC_HEIGHT))then
  call write_array_hdf(lun,sname,&
    & 'Geometric height of each pressure level  (levels,channels)',&
    & err,r2=x%GEOMETRIC_HEIGHT , units = 'm' ,compress=compress ,force_double=force_double)
  THROWM(err.ne.0,"CANNOT WRITE "//trim(sname))
endif

err=0_jpim
CATCH
end subroutine

end module
